# 黑洞模拟器频闪修复说明

## 问题描述
原代码中的黑洞模拟器存在明显的频闪问题，主要表现为：
1. 黑洞周围的光环和吸积盘闪烁
2. 事件视界警告线频闪
3. 粒子效果不稳定
4. 整体视觉效果不连贯

## 主要原因分析
1. **动态质量自适应系统**：系统会根据帧率动态调整渲染质量（高/中/低），导致不同帧的渲染效果不一致
2. **动态线宽和阴影**：各种视觉效果会根据质量档位动态调整线宽、阴影模糊等参数
3. **高频动画效果**：吸积盘条带、黑洞边缘脉动等效果使用了较高的频率，加剧了闪烁感

## 修复方案

### 1. 固定渲染质量
- 将 `dynamicQuality` 固定为 3（高质量）
- 禁用动态质量降级逻辑
- 确保每帧都使用相同的渲染参数

### 2. 固定渲染参数
- 线宽固定为高质量值
- 阴影模糊效果固定
- 粒子大小和发光效果固定
- 段数固定为100（高质量）

### 3. 降低动画频率
- 吸积盘条带动画频率：从 `time * spin` 降低到 `time * spin * 0.3`
- 黑洞边缘脉动：从 `time * 3` 降低到 `time * 1.5`，幅度从 2 降低到 1
- 中心脉冲：从 `time * 5` 降低到 `time * 2`，幅度从 5 降低到 2
- 事件视界警告线：从 `time * 2` 降低到 `time * 1`，透明度变化幅度从 0.2 降低到 0.1

### 4. 确保渲染一致性
- `shouldDrawHeavy()` 方法始终返回 `true`，确保每帧都绘制所有效果
- 禁用跳帧渲染逻辑
- 固定目标帧率为60fps

## 修改的文件
- `script.js`：主要的渲染逻辑和动画效果

## 修改的具体方法
1. `updateAdaptiveQuality()` - 禁用动态质量调整
2. `shouldDrawHeavy()` - 确保每帧渲染
3. `drawAccretionDisk()` - 固定线宽和阴影，降低动画频率
4. `drawBlackHole()` - 减少脉动效果
5. `drawEventHorizon()` - 降低警告线闪烁
6. `drawParticles()` - 固定粒子效果参数

## 预期效果
- 消除或显著减少频闪现象
- 保持稳定的高质量渲染
- 动画效果更加平滑自然
- 整体视觉体验更加连贯

## 注意事项
- 这些修改可能会略微增加GPU负载
- 建议在性能较好的设备上运行
- 如果仍有性能问题，可以考虑进一步降低动画频率
